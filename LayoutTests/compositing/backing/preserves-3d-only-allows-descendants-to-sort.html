<!DOCTYPE HTML>
<html>
<head>
  <style>
    .container {
      position: absolute;
      top: 10px;
      left: 10px;
      height: 100px;
      width: 100px;
      margin: 50px 50px;
      border: 1px solid blue;
      -webkit-transform-style: preserve-3d;
    }
    .card {
      position: absolute;
      top: 120px;
      left: 120px;
      margin: 10px;
      width: 100px;
      height: 100px;
    }
    #div1
    {
      background-color: green;
      -webkit-transform: translateZ(-10px);
    }
    #div2
    {
      background-color: red;
      -webkit-transform: translateZ(10px);
    }
    #div3
    {
      background-color: red:
      -webkit-transform: translateZ(-20px);
    }
    #div4
    {
      background-color: red:
      -webkit-transform: translateZ(-30px);
    }
  </style>
  <script>
    if (window.testRunner)
      testRunner.dumpAsTextWithPixelResults();
  </script>
</head>
<body>
  <!--
    This test ensures that if we have two layers were in separate 3d contexts, with
    parents in the 'composited-but-paint-into-ancestor' state, that they do not
    interfere with one another due to sorting, even if their ancestors are no longer
    composited at all. We also want to ensure that layers in the same 3d context DO
    sort wrt to one another.

    If this test succeeds, the green square should be on top of the red squares,
    hiding them.
  -->
  <div class="container">
    <div class="card" id="div2"></div>
  </div>
  <div class="container">
    <div class="card" id="div4"></div>
    <div class="card" id="div1"></div>
    <div class="card" id="div3"></div>
  </div>
</body>
</html>
