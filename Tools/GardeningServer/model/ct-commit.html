<!--
Copyright 2014 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<script>
function CTCommit(author, message, baseUrl) {
  this.author = author;
  this.message = message;
  this.revision = this._findRevision();
  this.summary = this._findSummary();
  this.url = this._url(baseUrl);
}

CTCommit.prototype._url = function(baseUrl) {
  return baseUrl + '?' + Object.toQueryString({
    view: 'rev',
    revision: this.revision,
  });
}

CTCommit.prototype._findRevision = function() {
  // FIXME: This needs to be updated post git-migration to
  // use the new commit numbers (ideally not git hashes!).
  var regexp = /git-svn-id:[^@]*@(\d+)/;
  var match = regexp.exec(this.message);
  if (match)
    return parseInt(match[1], 10);
  return null;
}

CTCommit.prototype._findSummary = function() {
  var index = this.message.indexOf('\n');
  return this.message.substring(0, index);
}
</script>
