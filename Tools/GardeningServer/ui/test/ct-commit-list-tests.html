<!--
Copyright 2014 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<link rel="import" href="../ct-commit-list.html">

<link rel="import" href="../../model/ct-commit-log-mock.html">

<script>
(function () {

var assert = chai.assert;

describe('ct-commit-list', function() {
  var list;

  beforeEach(function(done) {
    list = document.createElement('ct-commit-list');
    setTimeout(done);
  });

  describe('commit list UI', function() {
    beforeEach(function(done) {
      var repos = [
          { commits: [ new CTCommitMock(), new CTCommitMock() ],
            expanded: false },
          { commits: [ new CTCommitMock(), new CTCommitMock() ],
            expanded: false }
      ];

      var CommitList = Object.create(Object);
      CommitList.prototype.repositories = function() {
        return repos;
      };
      list.commitList = CommitList;

      setTimeout(done);
    });

    it('should show no commits by default', function() {
      var commits = list.shadowRoot.querySelectorAll('ct-commit');
      assert.lengthOf(commits, 0);
    });

    describe('expanded test', function() {
      beforeEach(function(done) {
        list.commitList.repositories().first().expanded = true;
        list.commitList.repositories().last().expanded = true;
        setTimeout(done);
      });

      it('should show commits when expanded', function() {
        assert.lengthOf(list.shadowRoot.querySelectorAll('ct-commit'), 4);
      });
    });
  });
});

})()
</script>
