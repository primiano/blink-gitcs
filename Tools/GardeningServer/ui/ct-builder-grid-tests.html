<!--
Copyright 2014 The Chromium Authors. All rights reserved.
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->

<link rel="import" href="ct-builder-grid.html">

<link rel="import" href="ct-builder.html">

<script>
(function () {

var kExampleFailures = [{
    "testName": "plugins/gesture-events-scrolled.html",
    "resultNodesByBuilder": {
        "WebKit Win7 (dbg)": {
            "actual": "CRASH",
            "masterUrl": "http://master-one",
            "earliestFailingBuild": "1",
        },
        "WebKit Mac10.6 (dbg)": {
            "actual": "CRASH",
            "masterUrl": "http://master-one",
            "earliestFailingBuild": "2",
        },
        "WebKit Mac10.7": {
            "actual": "TEXT",
            "masterUrl": "http://master-one",
            "earliestFailingBuild": "3",
        }
    },
    "oldestFailingRevision": 177164,
    "newestPassingRevision": 177165
}, {
    "testName": "plugins/transformed-events.html",
    "resultNodesByBuilder": {
        "WebKit Win7 (dbg)": {
            "actual": "TEXT",
            "masterUrl": "http://master-one",
            "earliestFailingBuild": "1",
        },
        "WebKit Mac10.7": {
            "actual": "CRASH",
            "masterUrl": "http://master-two",
            "earliestFailingBuild": "4",
        },
    },
    "oldestFailingRevision": 177164,
    "newestPassingRevision": 177165
}];

var kExampleBuilderLatestRevisions = {
  'WebKit Mac10.7': {
    blink: 177164,
  },
  'WebKit Mac10.6 (dbg)': {
    blink: 177166,
  },
  'WebKit Win7 (dbg)': {
    blink: 177166,
  },
};

module("ct-builder-grid");

asyncTest("basic", 5, function() {
  var grid = document.createElement('ct-builder-grid');
  grid.failures = kExampleFailures;

  requestAnimationFrame(function() {
    var builders = grid.shadowRoot.querySelectorAll('ct-builder');
    equal(builders.length, 4);
    deepEqual(builders[0].builder, new CTBuilder(
        'http://master-one', 'WebKit Mac10.6 (dbg)', '2'));
    deepEqual(builders[1].builder, new CTBuilder(
        'http://master-one', 'WebKit Mac10.7', '3'));
    deepEqual(builders[2].builder, new CTBuilder(
        'http://master-two', 'WebKit Mac10.7', '4'));
    deepEqual(builders[3].builder, new CTBuilder(
        'http://master-one', 'WebKit Win7 (dbg)', '1'));

    start();
  });
});

})()
</script>
